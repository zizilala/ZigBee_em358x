###############################################################################
#                                                                             #
# IAR ANSI C/C++ Compiler V6.40.2.53884/W32 for ARM     04/Feb/2015  16:38:08 #
# Copyright 1999-2012 IAR Systems AB.                                         #
#                                                                             #
#    Cpu mode     =  thumb                                                    #
#    Endian       =  little                                                   #
#    Source file  =  C:\Ember\EmberZNet5.3.0-GA\em35x\app\framework\util\proc #
#                    ess-global-message.c                                     #
#    Command line =  C:\Ember\EmberZNet5.3.0-GA\em35x\app\framework\util\proc #
#                    ess-global-message.c -D "GENERATED_TOKEN_HEADER=\"app/bu #
#                    ilder/DoorSensor_SM6011/DoorSensor_SM6011_tokens.h\""    #
#                    -D "ZA_GENERATED_HEADER=\"app/builder/DoorSensor_SM6011/ #
#                    DoorSensor_SM6011.h\"" -D LOCAL_STORAGE_BTL -D           #
#                    "BOARD_HEADER=\"app\builder\DoorSensor_SM6011\DoorSensor #
#                    _SM6011_board.h\"" -D "PLATFORM_HEADER=\"hal/micro/corte #
#                    xm3/compiler/iar.h\"" -D CORTEXM3 -D                     #
#                    CORTEXM3_EMBER_MICRO -D CORTEXM3_EM3585 -D PHY_EM3XX -D  #
#                    "APPLICATION_TOKEN_HEADER=\"app/framework/util/tokens.h\ #
#                    "" -D "CONFIGURATION_HEADER=\"app/framework/util/config. #
#                    h\"" -D "ATTRIBUTE_STORAGE_CONFIGURATION=\"app/builder/D #
#                    oorSensor_SM6011/DoorSensor_SM6011_endpoint_config.h\""  #
#                    -D "__SOURCEFILE__=\"process-global-message.c\"" -lC     #
#                    C:\Ember\EmberZNet5.3.0-GA\em35x\build\DoorSensor_SM6011 #
#                    \ --diag_suppress Pa050 -o C:\Ember\EmberZNet5.3.0-GA\em #
#                    35x\build\DoorSensor_SM6011\ --debug --endian=little     #
#                    --cpu=Cortex-M3 -e --fpu=None --dlib_config "C:\Program  #
#                    Files (x86)\IAR Systems\Embedded Workbench               #
#                    6.4\arm\INC\c\DLib_Config_Normal.h" -I                   #
#                    C:\Ember\EmberZNet5.3.0-GA\em35x\app\framework\util\ -I  #
#                    C:\Ember\EmberZNet5.3.0-GA\em35x\app\builder\DoorSensor_ #
#                    SM6011\ -I C:\Ember\EmberZNet5.3.0-GA\em35x\app\builder\ #
#                    DoorSensor_SM6011\..\..\..\ -I                           #
#                    C:\Ember\EmberZNet5.3.0-GA\em35x\app\builder\DoorSensor_ #
#                    SM6011\..\..\..\app\framework\include\ -I                #
#                    C:\Ember\EmberZNet5.3.0-GA\em35x\app\builder\DoorSensor_ #
#                    SM6011\..\..\..\ -I C:\Ember\EmberZNet5.3.0-GA\em35x\app #
#                    \builder\DoorSensor_SM6011\..\..\..\stack\ -I            #
#                    C:\Ember\EmberZNet5.3.0-GA\em35x\app\builder\DoorSensor_ #
#                    SM6011\..\..\..\hal\ -I C:\Ember\EmberZNet5.3.0-GA\em35x #
#                    \app\builder\DoorSensor_SM6011\..\..\..\hal\..\ -Ohz     #
#                    --use_c++_inline                                         #
#    List file    =  C:\Ember\EmberZNet5.3.0-GA\em35x\build\DoorSensor_SM6011 #
#                    \process-global-message.lst                              #
#    Object file  =  C:\Ember\EmberZNet5.3.0-GA\em35x\build\DoorSensor_SM6011 #
#                    \process-global-message.o                                #
#                                                                             #
#                                                                             #
###############################################################################

C:\Ember\EmberZNet5.3.0-GA\em35x\app\framework\util\process-global-message.c
      1          // *******************************************************************
      2          // * process-global-message.c
      3          // *
      4          // * This file contains function that processes global ZCL message.
      5          // *
      6          // * Copyright 2007 by Ember Corporation. All rights reserved.              *80*
      7          // *******************************************************************
      8          
      9          #include "../include/af.h"
     10          #include "common.h"
     11          #include "../plugin/ias-zone-client/ias-zone-client.h"
     12          #include "../plugin/key-establishment/key-establishment.h"
     13          #include "../plugin/smart-energy-registration/smart-energy-registration.h"
     14          #include "../plugin/trust-center-keepalive/trust-center-keepalive.h"
     15          #include "../plugin/test-harness/test-harness.h"
     16          
     17          // flag to keep track of the fact that we just sent a read attr for time and
     18          // we should set our time to the result of the read attr response.

   \                                 In section .bss, align 1
     19          boolean emAfSyncingTime = FALSE;
   \                     emAfSyncingTime:
   \   00000000                      DS8 1
     20          
     21          #ifndef EMBER_AF_DISCOVER_ATTRIBUTES_RESPONSE_MAXIMUM_ATTRIBUTE_LIMIT
     22            #define EMBER_AF_DISCOVER_ATTRIBUTES_RESPONSE_MAXIMUM_ATTRIBUTE_LIMIT 5
     23          #endif
     24          
     25          #if defined(EMBER_AF_SUPPORT_COMMAND_DISCOVERY)

   \                                 In section .text, align 2, keep-with-next
     26          static void printDiscoverCommandsResponse(boolean generated,
     27                                                    int16u clusterId,
     28                                                    boolean discoveryComplete,
     29                                                    int8u* buffer,
     30                                                    int16u length)
     31          {
   \                     printDiscoverCommandsResponse:
   \   00000000   0xB5F8             PUSH     {R3-R7,LR}
   \   00000002   0x461D             MOV      R5,R3
     32            int8u i;
     33            emberAfServiceDiscoveryPrint("Discover Commands response (complete: %c), %p IDs: ",
     34                                         (discoveryComplete
     35                                          ? 'y'
     36                                          : 'n'),
     37                                         (generated 
     38                                          ? "Generated"
     39                                          : "Received" ));
   \   00000004   0x2800             CMP      R0,#+0
   \   00000006   0xBF14             ITE      NE 
   \   00000008   0x.... 0x....      ADRNE.W  R3,`?<Constant "Generated">`
   \   0000000C   0x.... 0x....      ADREQ.W  R3,`?<Constant "Received">`
   \   00000010   0x2A00             CMP      R2,#+0
   \   00000012   0xBF14             ITE      NE 
   \   00000014   0x2279             MOVNE    R2,#+121
   \   00000016   0x226E             MOVEQ    R2,#+110
   \   00000018   0x.... 0x....      ADR.W    R1,`?<Constant "Discover Commands res...">`
   \   0000001C   0x2040             MOVS     R0,#+64
   \   0000001E   0x.... 0x....      BL       emberAfPrint
     40            for (i = 0; i < length; i++) {
   \   00000022   0x2600             MOVS     R6,#+0
   \   00000024   0x.... 0x....      ADR.W    R7,`?<Constant "0x%X ">`
   \   00000028   0x9C06             LDR      R4,[SP, #+24]
   \   0000002A   0xB2A4             UXTH     R4,R4
   \   0000002C   0xE006             B.N      ??printDiscoverCommandsResponse_0
     41              emberAfServiceDiscoveryPrint("0x%X ", buffer[i]);
   \                     ??printDiscoverCommandsResponse_1:
   \   0000002E   0xB2F6             UXTB     R6,R6
   \   00000030   0x5D72             LDRB     R2,[R6, R5]
   \   00000032   0x4639             MOV      R1,R7
   \   00000034   0x2040             MOVS     R0,#+64
   \   00000036   0x.... 0x....      BL       emberAfPrint
     42            }
   \   0000003A   0x1C76             ADDS     R6,R6,#+1
   \                     ??printDiscoverCommandsResponse_0:
   \   0000003C   0xB2F0             UXTB     R0,R6
   \   0000003E   0x42A0             CMP      R0,R4
   \   00000040   0xD3F5             BCC.N    ??printDiscoverCommandsResponse_1
     43            emberAfServiceDiscoveryPrintln("");
   \   00000042   0x....             ADR.N    R1,??DataTable18  ;; ""
   \   00000044   0x2040             MOVS     R0,#+64
   \   00000046   0xE8BD 0x40F4      POP      {R2,R4-R7,LR}
   \   0000004A   0x.... 0x....      B.W      emberAfPrintln
     44          }
     45          #endif
     46          

   \                                 In section .text, align 4, keep-with-next
     47          boolean emAfProcessGlobalCommand(EmberAfClusterCommand *cmd)
     48          {
   \                     emAfProcessGlobalCommand:
   \   00000000   0xE92D 0x4FF0      PUSH     {R4-R11,LR}
   \   00000004   0xB085             SUB      SP,SP,#+20
   \   00000006   0x4604             MOV      R4,R0
     49            int16u attrId;
     50            int8u frameControl;
     51            // This is a little clumsy but easier to read and port
     52            // from earlier implementation.
     53            EmberAfClusterId clusterId = cmd->apsFrame->clusterId;
   \   00000008   0x6820             LDR      R0,[R4, #+0]
   \   0000000A   0xF8B0 0x8002      LDRH     R8,[R0, #+2]
     54            int8u zclCmd = cmd->commandId;
   \   0000000E   0x7CE5             LDRB     R5,[R4, #+19]
     55            int8u *message = cmd->buffer;
   \   00000010   0xF8D4 0x9008      LDR      R9,[R4, #+8]
     56            int16u msgLen = cmd->bufLen;
   \   00000014   0x89A7             LDRH     R7,[R4, #+12]
     57            int16u msgIndex = cmd->payloadStartIndex;
   \   00000016   0x7D26             LDRB     R6,[R4, #+20]
     58            int8u clientServerMask = (cmd->direction == ZCL_DIRECTION_CLIENT_TO_SERVER
     59                                      ? CLUSTER_MASK_SERVER
     60                                      : CLUSTER_MASK_CLIENT);
   \   00000018   0x7D61             LDRB     R1,[R4, #+21]
   \   0000001A   0x2900             CMP      R1,#+0
   \   0000001C   0xBF0C             ITE      EQ 
   \   0000001E   0x2140             MOVEQ    R1,#+64
   \   00000020   0x2180             MOVNE    R1,#+128
   \   00000022   0xF88D 0x100C      STRB     R1,[SP, #+12]
     61          
     62            // If we are disabled then we can only respond to read or write commands
     63            // or identify cluster (see device enabled attr of basic cluster)
     64            if (!emberAfIsDeviceEnabled(cmd->apsFrame->destinationEndpoint)
     65                && zclCmd != ZCL_READ_ATTRIBUTES_COMMAND_ID
     66                && zclCmd != ZCL_WRITE_ATTRIBUTES_COMMAND_ID
     67                && zclCmd != ZCL_WRITE_ATTRIBUTES_UNDIVIDED_COMMAND_ID
     68                && zclCmd != ZCL_WRITE_ATTRIBUTES_NO_RESPONSE_COMMAND_ID
     69                && clusterId != ZCL_IDENTIFY_CLUSTER_ID) {
   \   00000026   0x7940             LDRB     R0,[R0, #+5]
   \   00000028   0x.... 0x....      BL       emberAfIsDeviceEnabled
   \   0000002C   0xB9C0             CBNZ.N   R0,??emAfProcessGlobalCommand_1
   \   0000002E   0x2D00             CMP      R5,#+0
   \   00000030   0xBF18             IT       NE 
   \   00000032   0x2D02             CMPNE    R5,#+2
   \   00000034   0xD014             BEQ.N    ??emAfProcessGlobalCommand_1
   \   00000036   0x2D03             CMP      R5,#+3
   \   00000038   0xBF1C             ITT      NE 
   \   0000003A   0x2D05             CMPNE    R5,#+5
   \   0000003C   0xF1B8 0x0F03      CMPNE    R8,#+3
   \   00000040   0xD00E             BEQ.N    ??emAfProcessGlobalCommand_1
     70              emberAfCorePrintln("disabled");
   \   00000042   0x.... 0x....      ADR.W    R1,`?<Constant "disabled">`
   \   00000046   0x2001             MOVS     R0,#+1
   \   00000048   0x.... 0x....      BL       emberAfPrintln
     71              emberAfDebugPrintln("%pd, dropping global cmd:%x", "disable", zclCmd);
   \   0000004C   0x462B             MOV      R3,R5
   \   0000004E   0x.... 0x....      ADR.W    R2,`?<Constant "disable">`
   \   00000052   0x.... 0x....      ADR.W    R1,`?<Constant "%pd, dropping global ...">`
   \   00000056   0x2002             MOVS     R0,#+2
   \   00000058   0x.... 0x....      BL       emberAfPrintln
     72              emberAfSendDefaultResponse(cmd, EMBER_ZCL_STATUS_FAILURE);
   \   0000005C   0x2101             MOVS     R1,#+1
   \   0000005E   0xE1E2             B.N      ??emAfProcessGlobalCommand_2
     73              return TRUE;
     74            }
     75          
     76            // If a manufacturer-specific command arrives using our special internal "not
     77            // manufacturer specific" code, we need to reject it outright without letting
     78            // it pass through to the rest of the code.  The internal read and write APIs
     79            // would interpret it as a standard attribute or cluster and return incorrect
     80            // results.
     81            if (cmd->mfgSpecific && cmd->mfgCode == EMBER_AF_NULL_MANUFACTURER_CODE) {
   \                     ??emAfProcessGlobalCommand_1:
   \   00000060   0x7BE0             LDRB     R0,[R4, #+15]
   \   00000062   0xB118             CBZ.N    R0,??emAfProcessGlobalCommand_3
   \   00000064   0x8A20             LDRH     R0,[R4, #+16]
   \   00000066   0x2800             CMP      R0,#+0
   \   00000068   0xF000 0x8130      BEQ.W    ??emAfProcessGlobalCommand_4
   \                     ??emAfProcessGlobalCommand_3:
   \   0000006C   0x.... 0x....      LDR.W    R0,??DataTable19_2
   \   00000070   0x2100             MOVS     R1,#+0
   \   00000072   0x8001             STRH     R1,[R0, #+0]
     82              goto kickout;
     83            }
     84          
     85            // Clear out the response buffer by setting its length to zero
     86            appResponseLength = 0;
     87          
     88            // Make the ZCL header for the response
     89            // note: cmd byte is set below
     90            frameControl = (ZCL_PROFILE_WIDE_COMMAND
     91                            | (cmd->direction == ZCL_DIRECTION_CLIENT_TO_SERVER
     92                               ? ZCL_FRAME_CONTROL_SERVER_TO_CLIENT 
     93                                 | EMBER_AF_DEFAULT_RESPONSE_POLICY_RESPONSES
     94                               : ZCL_FRAME_CONTROL_CLIENT_TO_SERVER 
     95                                 | EMBER_AF_DEFAULT_RESPONSE_POLICY_RESPONSES));
   \   00000074   0x7D60             LDRB     R0,[R4, #+21]
   \   00000076   0x2800             CMP      R0,#+0
   \   00000078   0xBF0C             ITE      EQ 
   \   0000007A   0x2008             MOVEQ    R0,#+8
   \   0000007C   0x2000             MOVNE    R0,#+0
     96            if (cmd->mfgSpecific) {
   \   0000007E   0x7BE1             LDRB     R1,[R4, #+15]
   \   00000080   0xB109             CBZ.N    R1,??emAfProcessGlobalCommand_5
     97              frameControl |= ZCL_MANUFACTURER_SPECIFIC_MASK;
   \   00000082   0xF040 0x0004      ORR      R0,R0,#0x4
     98            }
     99            emberAfPutInt8uInResp(frameControl);
   \                     ??emAfProcessGlobalCommand_5:
   \   00000086   0x.... 0x....      BL       emberAfPutInt8uInResp
    100            if (cmd->mfgSpecific) {
   \   0000008A   0x7BE0             LDRB     R0,[R4, #+15]
   \   0000008C   0xB110             CBZ.N    R0,??emAfProcessGlobalCommand_6
    101              emberAfPutInt16uInResp(cmd->mfgCode);
   \   0000008E   0x8A20             LDRH     R0,[R4, #+16]
   \   00000090   0x.... 0x....      BL       emberAfPutInt16uInResp
    102            }
    103            emberAfPutInt8uInResp(cmd->seqNum);
   \                     ??emAfProcessGlobalCommand_6:
   \   00000094   0x7CA0             LDRB     R0,[R4, #+18]
   \   00000096   0x.... 0x....      BL       emberAfPutInt8uInResp
    104          
    105          
    106            switch (zclCmd) {
   \   0000009A   0x1C70             ADDS     R0,R6,#+1
   \   0000009C   0xB280             UXTH     R0,R0
   \   0000009E   0xEBA7 0x0A06      SUB      R10,R7,R6
   \   000000A2   0xEB06 0x0B09      ADD      R11,R6,R9
   \   000000A6   0x2D16             CMP      R5,#+22
   \   000000A8   0xF200 0x810C      BHI.W    ??emAfProcessGlobalCommand_7
   \   000000AC   0xE8DF 0xF015      TBH      [PC, R5, LSL #+1]
   \                     ??emAfProcessGlobalCommand_0:
   \   000000B0   0x0017 0x0116      DC16     0x17,0x116,0x7B,0x3B
   \              0x007B 0x003B
   \   000000B8   0x0144 0x007B      DC16     0x144,0x7B,0x105,0x149
   \              0x0105 0x0149
   \   000000C0   0x0110 0x014E      DC16     0x110,0x14E,0x153,0x158
   \              0x0153 0x0158
   \   000000C8   0x00CE 0x016C      DC16     0xCE,0x16C,0x10A,0x10A
   \              0x010A 0x010A
   \   000000D0   0x010A 0x017C      DC16     0x10A,0x17C,0x1A6,0x17C
   \              0x01A6 0x017C
   \   000000D8   0x01B0 0x00CE      DC16     0x1B0,0xCE,0x16C
   \              0x016C       
    107          
    108            // The format of the read attributes cmd is:
    109            // ([attr ID:2]) * N
    110            // The format of the read attributes response is:
    111            // ([attr ID:2] [status:1] [data type:0/1] [data:0/N]) * N
    112            case ZCL_READ_ATTRIBUTES_COMMAND_ID:
    113              {
    114                emberAfAttributesPrintln("%p: clus %2x", "READ_ATTR", clusterId);
   \                     ??emAfProcessGlobalCommand_8:
   \   000000DE   0x4643             MOV      R3,R8
   \   000000E0   0x.... 0x....      ADR.W    R2,`?<Constant "READ_ATTR">`
   \   000000E4   0x.... 0x....      ADR.W    R1,`?<Constant "%p: clus %2x">`
   \   000000E8   0x2010             MOVS     R0,#+16
   \   000000EA   0x.... 0x....      BL       emberAfPrintln
    115                // Set the cmd byte - this is byte 3 index 2, but since we have
    116                // already incremented past the 3 byte ZCL header (our index is at 3),
    117                // this gets written to "-1" since 3 - 1 = 2.
    118                emberAfPutInt8uInResp(ZCL_READ_ATTRIBUTES_RESPONSE_COMMAND_ID);
   \   000000EE   0x2001             MOVS     R0,#+1
   \   000000F0   0x.... 0x....      BL       emberAfPutInt8uInResp
    119          
    120                // This message contains N 2-byte attr IDs after the 3 byte ZCL header,
    121                // for each one we need to look it up and make a response
    122                while (msgIndex + 2 <= msgLen) {
   \                     ??emAfProcessGlobalCommand_9:
   \   000000F4   0x1CB0             ADDS     R0,R6,#+2
   \   000000F6   0x4287             CMP      R7,R0
   \   000000F8   0xF2C0 0x80DC      BLT.W    ??emAfProcessGlobalCommand_10
    123                  // Get the attribute ID and store it in the response buffer
    124                  // least significant byte is first OTA
    125                  attrId = emberAfGetInt16u(message, msgIndex, msgLen);
   \   000000FC   0x.... 0x....      BL       ?Subroutine1
   \                     ??CrossCallReturnLabel_6:
   \   00000100   0x4602             MOV      R2,R0
    126          
    127                  // This function reads the attribute and creates the correct response
    128                  // in the response buffer
    129                  emberAfRetrieveAttributeAndCraftResponse(cmd->apsFrame->destinationEndpoint,
    130                                                           clusterId,
    131                                                           attrId,
    132                                                           clientServerMask,
    133                                                           cmd->mfgCode,
    134                                                           (EMBER_AF_RESPONSE_BUFFER_LEN
    135                                                            - appResponseLength));
   \   00000102   0x....             LDR.N    R0,??DataTable19_2
   \   00000104   0x8800             LDRH     R0,[R0, #+0]
   \   00000106   0xF1C0 0x0052      RSB      R0,R0,#+82
   \   0000010A   0xB280             UXTH     R0,R0
   \   0000010C   0x9001             STR      R0,[SP, #+4]
   \   0000010E   0x8A20             LDRH     R0,[R4, #+16]
   \   00000110   0x9000             STR      R0,[SP, #+0]
   \   00000112   0xF89D 0x300C      LDRB     R3,[SP, #+12]
   \   00000116   0x4641             MOV      R1,R8
   \   00000118   0x6820             LDR      R0,[R4, #+0]
   \   0000011A   0x7940             LDRB     R0,[R0, #+5]
   \   0000011C   0x.... 0x....      BL       emberAfRetrieveAttributeAndCraftResponse
    136          
    137                  // Go to next attrID
    138                  msgIndex += 2;
   \   00000120   0x1CB0             ADDS     R0,R6,#+2
   \   00000122   0xB286             UXTH     R6,R0
   \   00000124   0xE7E6             B.N      ??emAfProcessGlobalCommand_9
    139                }
    140              }
    141              emberAfSendResponse();
    142              return TRUE;
    143          
    144            // Write undivided means all attributes must be written in order to write
    145            // any of them. So first do a check. If the check fails, send back a fail
    146            // response. If it works, fall through to the normal write attr code.
    147            // write attr responses are the same for undivided and normal writes.
    148            case ZCL_WRITE_ATTRIBUTES_UNDIVIDED_COMMAND_ID:
    149              {
    150                int8u numFailures = 0;
   \                     ??emAfProcessGlobalCommand_11:
   \   00000126   0x2000             MOVS     R0,#+0
   \   00000128   0xF88D 0x000E      STRB     R0,[SP, #+14]
    151                int8u dataType;
    152                int8u dataSize;
    153                EmberAfStatus status;
    154          
    155                emberAfPutInt8uInResp(ZCL_WRITE_ATTRIBUTES_RESPONSE_COMMAND_ID);
   \   0000012C   0x2004             MOVS     R0,#+4
   \   0000012E   0x.... 0x....      BL       emberAfPutInt8uInResp
   \   00000132   0xE01C             B.N      ??CrossCallReturnLabel_20
    156          
    157                // Go through the message until there are no more attrID/type/data
    158                while (msgLen > msgIndex + 3) {
    159                  attrId = emberAfGetInt16u(message, msgIndex, msgLen);
    160                  dataType = emberAfGetInt8u(message, msgIndex + 2, msgLen);
    161          
    162                  // For strings, the data size is the length of the string (specified by
    163                  // the first byte of data) plus one for the length byte itself.  For
    164                  // everything else, the size is just the size of the data type.
    165                  dataSize = (emberAfIsThisDataTypeAStringType(dataType)
    166                              ? emberAfStringLength(message + msgIndex + 3) + 1
    167                              : emberAfGetDataSize(dataType));
   \                     ??emAfProcessGlobalCommand_12:
   \   00000134   0xF89D 0x000D      LDRB     R0,[SP, #+13]
   \   00000138   0x.... 0x....      BL       emberAfGetDataSize
   \   0000013C   0x4683             MOV      R11,R0
    168          
    169                  status = emberAfVerifyAttributeWrite(cmd->apsFrame->destinationEndpoint,
    170                                                       clusterId,
    171                                                       attrId,
    172                                                       clientServerMask,
    173                                                       cmd->mfgCode,
    174                                                       &(message[msgIndex + 3]),
    175                                                       dataType);
   \                     ??emAfProcessGlobalCommand_13:
   \   0000013E   0x.... 0x....      BL       ?Subroutine0
   \                     ??CrossCallReturnLabel_0:
   \   00000142   0x.... 0x....      BL       emberAfVerifyAttributeWrite
   \   00000146   0xF88D 0x0000      STRB     R0,[SP, #+0]
    176                  if (status != EMBER_ZCL_STATUS_SUCCESS) {
   \   0000014A   0xB170             CBZ.N    R0,??CrossCallReturnLabel_15
    177                    numFailures++;
   \   0000014C   0x.... 0x....      BL       ?Subroutine5
    178                    // Write to the response buffer - status and then attrID
    179                    emberAfPutInt8uInResp(status);
   \                     ??CrossCallReturnLabel_16:
   \   00000150   0xF89D 0x0000      LDRB     R0,[SP, #+0]
   \   00000154   0x.... 0x....      BL       emberAfPutInt8uInResp
    180                    emberAfPutInt16uInResp(attrId);
   \   00000158   0x4650             MOV      R0,R10
   \   0000015A   0x.... 0x....      BL       emberAfPutInt16uInResp
    181          
    182                    emberAfAttributesPrintln("WRITE: clus %2x attr %2x ", clusterId, attrId);
   \   0000015E   0x.... 0x....      BL       ?Subroutine6
   \                     ??CrossCallReturnLabel_18:
   \   00000162   0x.... 0x....      BL       emberAfPrintln
    183                    emberAfAttributesPrintln("FAIL %x", status);
   \   00000166   0x.... 0x....      BL       ?Subroutine4
    184                    emberAfCoreFlush();
    185                  }
    186          
    187                  // Increment past the attribute id (two bytes), the type (one byte), and
    188                  // the data (N bytes, including the length byte for strings).
    189                  msgIndex += 3 + dataSize;
   \                     ??CrossCallReturnLabel_15:
   \   0000016A   0x.... 0x....      BL       ?Subroutine7
   \                     ??CrossCallReturnLabel_20:
   \   0000016E   0x1CF0             ADDS     R0,R6,#+3
   \   00000170   0x42B8             CMP      R0,R7
   \   00000172   0xDA0C             BGE.N    ??emAfProcessGlobalCommand_14
   \   00000174   0x.... 0x....      BL       ?Subroutine1
    190                }
   \                     ??CrossCallReturnLabel_5:
   \   00000178   0x.... 0x....      BL       ?Subroutine3
   \                     ??CrossCallReturnLabel_13:
   \   0000017C   0x2800             CMP      R0,#+0
   \   0000017E   0xD0D9             BEQ.N    ??emAfProcessGlobalCommand_12
   \   00000180   0x9804             LDR      R0,[SP, #+16]
   \   00000182   0x1CC0             ADDS     R0,R0,#+3
   \   00000184   0x.... 0x....      BL       emberAfStringLength
   \   00000188   0xF100 0x0B01      ADD      R11,R0,#+1
   \   0000018C   0xE7D7             B.N      ??emAfProcessGlobalCommand_13
    191                // If there are any failures, send the response and exit
    192                if (numFailures > 0) {
   \                     ??emAfProcessGlobalCommand_14:
   \   0000018E   0xF89D 0x000E      LDRB     R0,[SP, #+14]
   \   00000192   0x2800             CMP      R0,#+0
   \   00000194   0xD158             BNE.N    ??emAfProcessGlobalCommand_15
    193                  emberAfSendResponse();
    194                  return TRUE;
    195                }
    196              }
    197              // Reset message back to start
    198              msgIndex = cmd->payloadStartIndex;
   \   00000196   0x7D26             LDRB     R6,[R4, #+20]
    199              appResponseLength = (cmd->mfgSpecific ? 4 : 2);
   \   00000198   0x7BE0             LDRB     R0,[R4, #+15]
   \   0000019A   0x2800             CMP      R0,#+0
   \   0000019C   0xBF14             ITE      NE 
   \   0000019E   0x2004             MOVNE    R0,#+4
   \   000001A0   0x2002             MOVEQ    R0,#+2
   \   000001A2   0x....             LDR.N    R1,??DataTable19_2
   \   000001A4   0x8008             STRH     R0,[R1, #+0]
    200              // DO NOT BREAK from this case
    201          
    202            // the format of the write attributes cmd is:
    203            // ([attr ID:2] [data type:1] [data:N]) * N
    204            // the format of the write attributes response is:
    205            // ([status 1] [attr ID 2]) * n
    206            // ONLY errors are reported unless all are successful then a single success
    207            // is sent. write attr no response is handled by just executing the same
    208            // code but not setting the flag that sends the response at the end.
    209            case ZCL_WRITE_ATTRIBUTES_NO_RESPONSE_COMMAND_ID:
    210            case ZCL_WRITE_ATTRIBUTES_COMMAND_ID:
    211              {
    212                int8u numFailures = 0;
   \                     ??emAfProcessGlobalCommand_16:
   \   000001A6   0x2000             MOVS     R0,#+0
    213                int8u numSuccess = 0;
   \   000001A8   0xF8AD 0x000E      STRH     R0,[SP, #+14]
    214                int8u dataType;
    215                int8u dataSize;
    216          #if (BIGENDIAN_CPU)
    217                int8u writeData[ATTRIBUTE_LARGEST];
    218          #endif //(BIGENDIAN_CPU)
    219                EmberAfStatus status;
    220          
    221                // set the cmd byte - this is byte 3 index 2, but since we have
    222                // already incremented past the 3 byte ZCL header (our index is at 3),
    223                // this gets written to "-1" since 3 - 1 = 2.
    224                emberAfPutInt8uInResp(ZCL_WRITE_ATTRIBUTES_RESPONSE_COMMAND_ID);
   \   000001AC   0x2004             MOVS     R0,#+4
   \   000001AE   0x.... 0x....      BL       emberAfPutInt8uInResp
   \   000001B2   0xE00F             B.N      ??CrossCallReturnLabel_21
    225          
    226                // go through the message until there are no more attrID/type/data
    227                while (msgLen > msgIndex + 3) {
    228                  attrId = emberAfGetInt16u(message, msgIndex, msgLen);
    229                  dataType = emberAfGetInt8u(message, msgIndex + 2, msgLen);
    230          
    231                  // For strings, the data size is the length of the string (specified by
    232                  // the first byte of data) plus one for the length byte itself.  For
    233                  // everything else, the size is just the size of the data type.
    234                  dataSize = (emberAfIsThisDataTypeAStringType(dataType)
    235                              ? emberAfStringLength(message + msgIndex + 3) + 1
    236                              : emberAfGetDataSize(dataType));
    237          
    238                  // the data is sent little endian over-the-air, it needs to be
    239                  // inserted into the table big endian for the EM250 and little
    240                  // endian for the EZSP hosts. This means for the EM250 the data
    241                  // needs to be reversed before sending to writeAttributes
    242          #if (BIGENDIAN_CPU)
    243                    // strings go over the air as length byte and then in human
    244                    // readable format. These should not be flipped.
    245                    if (emberAfIsThisDataTypeAStringType(dataType)) {
    246                      MEMCOPY(writeData, message + msgIndex + 3, dataSize);
    247                    } else {
    248                      // the data is sent little endian over-the-air, it needs to be
    249                      // inserted into the table big endian
    250                      int8u i;
    251                      for (i = 0; i < dataSize; i++) {
    252                        writeData[i] = message[msgIndex + 3 + dataSize - i - 1];
    253                      }
    254                    }
    255          #endif //(BIGENDIAN_CPU)
    256          
    257                    status = emberAfWriteAttributeExternal(cmd->apsFrame->destinationEndpoint,
    258                                                           clusterId,
    259                                                           attrId,
    260                                                           clientServerMask,
    261                                                           cmd->mfgCode,
    262          #if (BIGENDIAN_CPU)
    263                                                           writeData,
    264          #else //(BIGENDIAN_CPU)
    265                                                           &(message[msgIndex + 3]),
    266          #endif //(BIGENDIAN_CPU)
    267                                                           dataType);
    268                    emberAfAttributesPrint("WRITE: clus %2x attr %2x ",
    269                                             clusterId,
    270                                             attrId);
    271                    if (status == EMBER_ZCL_STATUS_SUCCESS) {
    272                      numSuccess++;
    273                      emberAfAttributesPrintln("OK");
    274                    } else {
    275                      numFailures++;
   \                     ??emAfProcessGlobalCommand_17:
   \   000001B4   0xF89D 0x000F      LDRB     R0,[SP, #+15]
   \   000001B8   0x1C40             ADDS     R0,R0,#+1
   \   000001BA   0xF88D 0x000F      STRB     R0,[SP, #+15]
    276                      // write to the response buffer - status and then attrID
    277                      emberAfPutInt8uInResp(status);
   \   000001BE   0xF89D 0x0000      LDRB     R0,[SP, #+0]
   \   000001C2   0x.... 0x....      BL       emberAfPutInt8uInResp
    278                      emberAfPutInt16uInResp(attrId);
   \   000001C6   0x4650             MOV      R0,R10
   \   000001C8   0x.... 0x....      BL       emberAfPutInt16uInResp
    279                      emberAfAttributesPrintln("FAIL %x",  status);
   \   000001CC   0x.... 0x....      BL       ?Subroutine4
    280                    }
    281                    emberAfCoreFlush();
    282          
    283                  // Increment past the attribute id (two bytes), the type (one byte), and
    284                  // the data (N bytes, including the length byte for strings).
    285                  msgIndex += 3 + dataSize;
   \                     ??CrossCallReturnLabel_14:
   \   000001D0   0x.... 0x....      BL       ?Subroutine7
   \                     ??CrossCallReturnLabel_21:
   \   000001D4   0x1CF0             ADDS     R0,R6,#+3
   \   000001D6   0x42B8             CMP      R0,R7
   \   000001D8   0xDA25             BGE.N    ??emAfProcessGlobalCommand_18
   \   000001DA   0x.... 0x....      BL       ?Subroutine1
   \                     ??CrossCallReturnLabel_4:
   \   000001DE   0x.... 0x....      BL       ?Subroutine3
   \                     ??CrossCallReturnLabel_12:
   \   000001E2   0xB130             CBZ.N    R0,??emAfProcessGlobalCommand_19
   \   000001E4   0x9804             LDR      R0,[SP, #+16]
   \   000001E6   0x1CC0             ADDS     R0,R0,#+3
   \   000001E8   0x.... 0x....      BL       emberAfStringLength
   \   000001EC   0xF100 0x0B01      ADD      R11,R0,#+1
   \   000001F0   0xE004             B.N      ??emAfProcessGlobalCommand_20
   \                     ??emAfProcessGlobalCommand_19:
   \   000001F2   0xF89D 0x000D      LDRB     R0,[SP, #+13]
   \   000001F6   0x.... 0x....      BL       emberAfGetDataSize
   \   000001FA   0x4683             MOV      R11,R0
   \                     ??emAfProcessGlobalCommand_20:
   \   000001FC   0x.... 0x....      BL       ?Subroutine0
   \                     ??CrossCallReturnLabel_1:
   \   00000200   0x.... 0x....      BL       emberAfWriteAttributeExternal
   \   00000204   0xF88D 0x0000      STRB     R0,[SP, #+0]
   \   00000208   0x.... 0x....      BL       ?Subroutine6
   \                     ??CrossCallReturnLabel_19:
   \   0000020C   0x.... 0x....      BL       emberAfPrint
   \   00000210   0xF89D 0x0000      LDRB     R0,[SP, #+0]
   \   00000214   0x2800             CMP      R0,#+0
   \   00000216   0xD1CD             BNE.N    ??emAfProcessGlobalCommand_17
   \   00000218   0x.... 0x....      BL       ?Subroutine5
   \                     ??CrossCallReturnLabel_17:
   \   0000021C   0x....             ADR.N    R1,??DataTable19  ;; 0x4F, 0x4B, 0x00, 0x00
   \   0000021E   0x2010             MOVS     R0,#+16
   \   00000220   0x.... 0x....      BL       emberAfPrintln
   \   00000224   0xE7D4             B.N      ??CrossCallReturnLabel_14
    286                }
    287          
    288                if (numFailures == 0) {
   \                     ??emAfProcessGlobalCommand_18:
   \   00000226   0xF89D 0x000F      LDRB     R0,[SP, #+15]
   \   0000022A   0xB960             CBNZ.N   R0,??emAfProcessGlobalCommand_21
    289                  // if no failures and no success this means the packet was too short
    290                  // print an error message but still return TRUE as we consumed the
    291                  // message
    292                  if (numSuccess == 0) {
   \   0000022C   0xF89D 0x000E      LDRB     R0,[SP, #+14]
   \   00000230   0xB930             CBNZ.N   R0,??emAfProcessGlobalCommand_22
    293                    emberAfAttributesPrintln("WRITE: too short");
   \   00000232   0x.... 0x....      ADR.W    R1,`?<Constant "WRITE: too short">`
   \   00000236   0x2010             MOVS     R0,#+16
   \   00000238   0x.... 0x....      BL       emberAfPrintln
    294                    emberAfSendDefaultResponse(cmd, EMBER_ZCL_STATUS_MALFORMED_COMMAND);
   \   0000023C   0x2180             MOVS     R1,#+128
   \   0000023E   0xE0F2             B.N      ??emAfProcessGlobalCommand_2
    295                    return TRUE;
    296                  }
    297                  // if no failures and at least one success, write a success status
    298                  // that means everything worked
    299                  else {
    300                    emberAfPutInt8uInResp(EMBER_ZCL_STATUS_SUCCESS);
   \                     ??emAfProcessGlobalCommand_22:
   \   00000240   0x2000             MOVS     R0,#+0
   \   00000242   0x.... 0x....      BL       emberAfPutInt8uInResp
    301                  }
    302                }
    303                // always send a response unless the cmd requested no response
    304                if (zclCmd == ZCL_WRITE_ATTRIBUTES_NO_RESPONSE_COMMAND_ID) {
   \                     ??emAfProcessGlobalCommand_21:
   \   00000246   0x2D05             CMP      R5,#+5
   \                     ??emAfProcessGlobalCommand_15:
   \   00000248   0xD134             BNE.N    ??emAfProcessGlobalCommand_10
    305                  emberAfSendDefaultResponse(cmd, EMBER_ZCL_STATUS_SUCCESS);
   \   0000024A   0xE0EB             B.N      ??emAfProcessGlobalCommand_23
    306                  return TRUE;
    307                }
    308                emberAfSendResponse();
    309                return TRUE;
    310              }
    311          
    312            // the format of discover is: [start attr ID:2] [max attr IDs:1]
    313            // the format of the response is: [done:1] ([attrID:2] [type:1]) * N
    314            case ZCL_DISCOVER_ATTRIBUTES_COMMAND_ID:
    315            case ZCL_DISCOVER_ATTRIBUTES_EXTENDED_COMMAND_ID:
    316              {
    317                EmberAfAttributeId startingAttributeId;
    318                int8u numberAttributes;
    319                boolean *complete;
    320          
    321                emberAfAttributesPrintln("%p%p: clus %2x", "DISC_ATTR",
    322                    (zclCmd == ZCL_DISCOVER_ATTRIBUTES_EXTENDED_COMMAND_ID ? "_EXT" : ""), 
    323                    clusterId);
   \                     ??emAfProcessGlobalCommand_24:
   \   0000024C   0x2D15             CMP      R5,#+21
   \   0000024E   0xBF0C             ITE      EQ 
   \   00000250   0x.... 0x....      ADREQ.W  R3,`?<Constant "_EXT">`
   \   00000254   0x....             ADRNE.N  R3,??DataTable19_1  ;; ""
   \   00000256   0xF8CD 0x8000      STR      R8,[SP, #+0]
   \   0000025A   0x.... 0x....      ADR.W    R2,`?<Constant "DISC_ATTR">`
   \   0000025E   0x.... 0x....      ADR.W    R1,`?<Constant "%p%p: clus %2x">`
   \   00000262   0x2010             MOVS     R0,#+16
   \   00000264   0x.... 0x....      BL       emberAfPrintln
    324          
    325                // set the cmd byte - this is byte 3 index 2, but since we have
    326                // already incremented past the 3 byte ZCL header (our index is at 3),
    327                // this gets written to "-1" since 3 - 1 = 2.
    328                emberAfPutInt8uInResp(
    329                  (zclCmd == ZCL_DISCOVER_ATTRIBUTES_COMMAND_ID ? 
    330                   ZCL_DISCOVER_ATTRIBUTES_RESPONSE_COMMAND_ID :
    331                   ZCL_DISCOVER_ATTRIBUTES_EXTENDED_RESPONSE_COMMAND_ID));
   \   00000268   0x2D0C             CMP      R5,#+12
   \   0000026A   0xBF0C             ITE      EQ 
   \   0000026C   0x200D             MOVEQ    R0,#+13
   \   0000026E   0x2016             MOVNE    R0,#+22
   \   00000270   0x.... 0x....      BL       emberAfPutInt8uInResp
    332          
    333                // get the attrId to start on and the max count
    334                startingAttributeId = emberAfGetInt16u(message, msgIndex, msgLen);
   \   00000274   0x.... 0x....      BL       ?Subroutine1
   \                     ??CrossCallReturnLabel_3:
   \   00000278   0x4681             MOV      R9,R0
    335                numberAttributes = emberAfGetInt8u(message, msgIndex + 2, msgLen);
   \   0000027A   0xF89B 0x7002      LDRB     R7,[R11, #+2]
    336          
    337                // BUGZID: EMAPPFWKV2-828
    338                // If we try to return more than 5 attributes at a time we run the
    339                // risk of a) building a tx buffer that is too large and failing to respond
    340                // or b) responding that we have completed discovery with a truncated buffer. 
    341                // Therefore we are throttling attribute discovery to !>5 attributes in a response.
    342                if (numberAttributes > EMBER_AF_DISCOVER_ATTRIBUTES_RESPONSE_MAXIMUM_ATTRIBUTE_LIMIT)
   \   0000027E   0x2F06             CMP      R7,#+6
   \   00000280   0xBF28             IT       CS 
   \   00000282   0x2705             MOVCS    R7,#+5
    343          		numberAttributes = EMBER_AF_DISCOVER_ATTRIBUTES_RESPONSE_MAXIMUM_ATTRIBUTE_LIMIT;
    344          
    345                // The response has a one-byte field indicating whether discovery is
    346                // complete.  We can't populate that field until we've finished going
    347                // through all the attributes, so save a placeholder, write a temporary
    348                // value for now (so that the offset moves forward), and write the real
    349                // value when we're done.
    350                complete = &(appResponseData[appResponseLength]);
   \   00000284   0x....             LDR.N    R0,??DataTable19_2
   \   00000286   0x8800             LDRH     R0,[R0, #+0]
   \   00000288   0x....             LDR.N    R1,??DataTable19_3
   \   0000028A   0x1846             ADDS     R6,R0,R1
    351                emberAfPutInt8uInResp(FALSE);
   \   0000028C   0x2000             MOVS     R0,#+0
   \   0000028E   0x.... 0x....      BL       emberAfPutInt8uInResp
    352                *complete = emberAfReadSequentialAttributesAddToResponse(
    353                              cmd->apsFrame->destinationEndpoint,
    354                              clusterId,
    355                              startingAttributeId,
    356                              clientServerMask,
    357                              cmd->mfgCode,
    358                              numberAttributes,
    359                              (zclCmd == ZCL_DISCOVER_ATTRIBUTES_EXTENDED_COMMAND_ID));
   \   00000292   0x2D15             CMP      R5,#+21
   \   00000294   0xBF0C             ITE      EQ 
   \   00000296   0x2001             MOVEQ    R0,#+1
   \   00000298   0x2000             MOVNE    R0,#+0
   \   0000029A   0x9002             STR      R0,[SP, #+8]
   \   0000029C   0x9701             STR      R7,[SP, #+4]
   \   0000029E   0x8A20             LDRH     R0,[R4, #+16]
   \   000002A0   0x9000             STR      R0,[SP, #+0]
   \   000002A2   0xF89D 0x300C      LDRB     R3,[SP, #+12]
   \   000002A6   0x464A             MOV      R2,R9
   \   000002A8   0x4641             MOV      R1,R8
   \   000002AA   0x6820             LDR      R0,[R4, #+0]
   \   000002AC   0x7940             LDRB     R0,[R0, #+5]
   \   000002AE   0x.... 0x....      BL       emberAfReadSequentialAttributesAddToResponse
   \   000002B2   0x7030             STRB     R0,[R6, #+0]
    360                emberAfSendResponse();
    361                return TRUE;
    362              }
   \                     ??emAfProcessGlobalCommand_10:
   \   000002B4   0x.... 0x....      BL       emberAfSendResponse
   \                     ??emAfProcessGlobalCommand_25:
   \   000002B8   0xE0B8             B.N      ??emAfProcessGlobalCommand_26
    363          
    364            case ZCL_CONFIGURE_REPORTING_COMMAND_ID:
    365              if (emberAfConfigureReportingCommandCallback(cmd)) {
   \                     ??emAfProcessGlobalCommand_27:
   \   000002BA   0x4620             MOV      R0,R4
   \   000002BC   0x.... 0x....      BL       emberAfConfigureReportingCommandCallback
   \   000002C0   0x2800             CMP      R0,#+0
   \   000002C2   0xD1F9             BNE.N    ??emAfProcessGlobalCommand_25
    366                return TRUE;
    367              }
    368              break;
    369          
    370            case ZCL_READ_REPORTING_CONFIGURATION_COMMAND_ID:
    371              if (emberAfReadReportingConfigurationCommandCallback(cmd)) {
    372                return TRUE;
    373              }
    374              break;
    375          
    376            // ([attribute id:2] [status:1] [type:0/1] [value:0/V])+
    377            case ZCL_READ_ATTRIBUTES_RESPONSE_COMMAND_ID:
    378              // The "timesync" command in the CLI sends a Read Attributes command for the
    379              // Time attribute on another device and then sets a flag.  If that flag is
    380              // set and a Read Attributes Response command for the time comes in, we set
    381              // the time to the value in the message.
    382              if (clusterId == ZCL_TIME_CLUSTER_ID) {
    383                if (emAfSyncingTime
    384                    && !cmd->mfgSpecific
    385                    && msgLen - msgIndex == 8 // attr:2 status:1 type:1 data:4
    386                    && (emberAfGetInt16u(message, msgIndex, msgLen)
    387                        == ZCL_TIME_ATTRIBUTE_ID)
    388                    && (emberAfGetInt8u(message, msgIndex + 2, msgLen)
    389                        == EMBER_ZCL_STATUS_SUCCESS)
    390                    && (emberAfGetInt8u(message, msgIndex + 3, msgLen)
    391                        == ZCL_UTC_TIME_ATTRIBUTE_TYPE)) {
    392                  emberAfSetTime(emberAfGetInt32u(message, msgIndex + 4, msgLen));
    393                  emberAfDebugPrintln("time sync ok, time: %4x", emberAfGetCurrentTime());
    394                  emAfSyncingTime = FALSE;
    395                }
    396          #ifdef EMBER_AF_PLUGIN_SMART_ENERGY_REGISTRATION_ESI_DISCOVERY_REQUIRED
    397                emAfPluginSmartEnergyRegistrationReadAttributesResponseCallback(message + msgIndex,
    398                                                                                msgLen - msgIndex);
    399          #endif //EMBER_AF_PLUGIN_SMART_ENERGY_REGISTRATION_ESI_DISCOVERY_REQUIRED
    400              }
    401          
    402          #ifdef EMBER_AF_PLUGIN_TRUST_CENTER_KEEPALIVE
    403              if (clusterId == ZCL_KEY_ESTABLISHMENT_CLUSTER_ID
    404                  && !cmd->mfgSpecific
    405                  && msgLen - msgIndex == 6 // attr:2 status:1 type:1 data:2
    406                  && (emberAfGetInt16u(message, msgIndex, msgLen)
    407                      == ZCL_KEY_ESTABLISHMENT_SUITE_SERVER_ATTRIBUTE_ID)) {
    408                emAfPluginTrustCenterKeepaliveReadAttributesResponseCallback(message + msgIndex,
    409                                                                             msgLen - msgIndex);
    410              }
    411          #endif //EMBER_AF_PLUGIN_TRUST_CENTER_KEEPALIVE
    412          
    413          #if defined(EMBER_AF_PLUGIN_KEY_ESTABLISHMENT)
    414              if (clusterId == ZCL_KEY_ESTABLISHMENT_CLUSTER_ID
    415                  && !cmd->mfgSpecific
    416                  && msgLen - msgIndex == 6 //attr:2 status:1 type:1 data:2
    417                  && (emberAfGetInt16u(message,msgIndex,msgLen)
    418                      == ZCL_KEY_ESTABLISHMENT_SUITE_CLIENT_ATTRIBUTE_ID)
    419                  && (emberAfGetInt8u(message, msgIndex + 2, msgLen)
    420                      == EMBER_ZCL_STATUS_SUCCESS)
    421                  && (emberAfGetInt8u(message,msgIndex + 3,msgLen)
    422                      == ZCL_ENUM16_ATTRIBUTE_TYPE)){
    423                int16u suite = emberAfGetInt16u(message,msgIndex+4,msgLen);
    424                emberAfPluginKeyEstablishmentReadAttributesCallback(suite);
    425              }
    426          #endif
    427          
    428          #if defined(EMBER_AF_PLUGIN_TEST_HARNESS)
    429              emberAfPluginTestHarnessReadAttributesResponseCallback(clusterId,
    430                                                                     message + msgIndex,
    431                                                                     msgLen - msgIndex);
    432          #endif
    433          
    434          #if defined(EMBER_AF_PLUGIN_IAS_ZONE_CLIENT)
    435              emberAfPluginIasZoneClientReadAttributesResponseCallback(clusterId,
    436                                                                       message + msgIndex,
    437                                                                       msgLen - msgIndex);
    438          #endif
    439          
    440              if (!emberAfReadAttributesResponseCallback(clusterId,
    441                                                         message + msgIndex,
    442                                                         msgLen - msgIndex)) {
    443                emberAfSendDefaultResponse(cmd, EMBER_ZCL_STATUS_SUCCESS);
    444              }
    445              return TRUE;
    446          
    447            // ([status:1] [attribute id:2])+
    448            case ZCL_WRITE_ATTRIBUTES_RESPONSE_COMMAND_ID:
    449          
    450            #if defined(EMBER_AF_PLUGIN_TEST_HARNESS)
    451              emberAfPluginTestHarnessWriteAttributesResponseCallback(clusterId,
    452                                                                      message + msgIndex,
    453                                                                      msgLen - msgIndex);
    454            #endif
    455          
    456            #if defined(EMBER_AF_PLUGIN_IAS_ZONE_CLIENT)
    457              emberAfPluginIasZoneClientWriteAttributesResponseCallback(clusterId,
    458                                                                        message + msgIndex,
    459                                                                        msgLen - msgIndex);
    460            #endif
    461          
    462              if (!emberAfWriteAttributesResponseCallback(clusterId,
    463                                                          message + msgIndex,
    464                                                          msgLen - msgIndex)) {
    465                emberAfSendDefaultResponse(cmd, EMBER_ZCL_STATUS_SUCCESS);
    466              }
    467              return TRUE;
    468          
    469            // ([status:1] [direction:1] [attribute id:2])+
    470            case ZCL_CONFIGURE_REPORTING_RESPONSE_COMMAND_ID:
    471              if (!emberAfConfigureReportingResponseCallback(clusterId,
    472                                                             message + msgIndex,
    473                                                             msgLen - msgIndex)) {
    474                emberAfSendDefaultResponse(cmd, EMBER_ZCL_STATUS_SUCCESS);
    475              }
    476              return TRUE;
    477          
    478          
    479            // ([status:1] [direction:1] [attribute id:2] [type:0/1] ...
    480            // ... [min interval:0/2] [max interval:0/2] [reportable change:0/V] ...
    481            // ... [timeout:0/2])+
    482            case ZCL_READ_REPORTING_CONFIGURATION_RESPONSE_COMMAND_ID:
    483              if (!emberAfReadReportingConfigurationResponseCallback(clusterId,
    484                                                                     message + msgIndex,
    485                                                                     msgLen - msgIndex)) {
    486                emberAfSendDefaultResponse(cmd, EMBER_ZCL_STATUS_SUCCESS);
    487              }
    488              return TRUE;
    489          
    490            // ([attribute id:2] [type:1] [data:V])+
    491            case ZCL_REPORT_ATTRIBUTES_COMMAND_ID:
    492              if (!emberAfReportAttributesCallback(clusterId,
    493                                                   message + msgIndex,
    494                                                   msgLen - msgIndex)) {
    495                emberAfSendDefaultResponse(cmd, EMBER_ZCL_STATUS_SUCCESS);
    496              }
    497              return TRUE;
    498          
    499            // [command id:1] [status:1]
    500            case ZCL_DEFAULT_RESPONSE_COMMAND_ID:
    501              {
    502                EmberAfStatus status;
    503                int8u commandId;
    504                commandId = emberAfGetInt8u(message, msgIndex, msgLen);
    505                msgIndex++;
    506                status = (EmberAfStatus)emberAfGetInt8u(message, msgIndex, msgLen);
    507          
    508                emberAfClusterDefaultResponseCallback(cmd->apsFrame->destinationEndpoint,
    509                                                      clusterId,
    510                                                      commandId,
    511                                                      status,
    512                                                      clientServerMask);
    513                emberAfDefaultResponseCallback(clusterId, commandId, status);
    514                return TRUE;
    515              }
    516          
    517            // [discovery complete:1] ([attribute id:2] [type:1])*
    518            case ZCL_DISCOVER_ATTRIBUTES_RESPONSE_COMMAND_ID:
    519            case ZCL_DISCOVER_ATTRIBUTES_EXTENDED_RESPONSE_COMMAND_ID:
    520              {
    521                boolean discoveryComplete = emberAfGetInt8u(message, msgIndex, msgLen);
    522                msgIndex++;
    523                if (!emberAfDiscoverAttributesResponseCallback(clusterId,
    524                                                               discoveryComplete,
    525                                                               message + msgIndex,
    526                                                               msgLen - msgIndex,
    527          												     (zclCmd == 
    528          												      ZCL_DISCOVER_ATTRIBUTES_EXTENDED_RESPONSE_COMMAND_ID))) {
    529                  emberAfSendDefaultResponse(cmd, EMBER_ZCL_STATUS_SUCCESS);
    530                }
    531                return TRUE;
    532              }
    533          
    534          #ifdef EMBER_AF_SUPPORT_COMMAND_DISCOVERY
    535              // Command discovery takes a bit of flash because we need to add structs 
    536              // for commands into the generated hader. Hence it's all configurable.
    537            case ZCL_DISCOVER_COMMANDS_RECEIVED_COMMAND_ID:
    538            case ZCL_DISCOVER_COMMANDS_GENERATED_COMMAND_ID:
    539              {
    540                int8u startCommandIdentifier = emberAfGetInt8u(message, msgIndex, msgLen);
    541                int8u maximumCommandIdentifiers = emberAfGetInt8u(message, msgIndex+1, msgLen);
    542                int16u savedIndex;
    543                boolean flag;
    544                
    545                // Ok. This is the command that matters.
    546                if ( zclCmd == ZCL_DISCOVER_COMMANDS_RECEIVED_COMMAND_ID ) {
    547                  emberAfPutInt8uInResp(ZCL_DISCOVER_COMMANDS_RECEIVED_RESPONSE_COMMAND_ID);
    548                  flag = FALSE;
    549                } else {
    550                  emberAfPutInt8uInResp(ZCL_DISCOVER_COMMANDS_GENERATED_RESPONSE_COMMAND_ID);
    551                  flag = TRUE;
    552                }
    553                savedIndex = appResponseLength;
    554                flag = emberAfExtractCommandIds(flag,
    555                                                cmd,
    556                                                clusterId,
    557                                                appResponseData + appResponseLength + 1,
    558                                                EMBER_AF_RESPONSE_BUFFER_LEN - appResponseLength - 1,
    559                                                &appResponseLength,
    560                                                startCommandIdentifier,
    561                                                maximumCommandIdentifiers);
    562                appResponseData[savedIndex] = ( flag ? 1 : 0 );
    563                appResponseLength++;
    564                emberAfSendResponse();
    565                return TRUE;
    566              }
    567            case ZCL_DISCOVER_COMMANDS_RECEIVED_RESPONSE_COMMAND_ID:
    568              {
    569                boolean discoveryComplete = emberAfGetInt8u(message, msgIndex, msgLen);
    570                msgIndex++;
    571                printDiscoverCommandsResponse(FALSE,  // is ZCL command generated?
    572                                              clusterId,
    573                                              discoveryComplete,
    574                                              message + msgIndex,
    575                                              msgLen - msgIndex);
    576                if(!emberAfDiscoverCommandsReceivedResponseCallback(clusterId,
    577                                                                    cmd->mfgCode,
    578                                                                    discoveryComplete,
    579                                                                    message+msgIndex,
    580                                                                    msgLen-msgIndex)) {
    581                  emberAfSendDefaultResponse(cmd, EMBER_ZCL_STATUS_SUCCESS);
    582                }
    583                return TRUE;
    584              }
    585            case ZCL_DISCOVER_COMMANDS_GENERATED_RESPONSE_COMMAND_ID:
    586              {
    587                boolean discoveryComplete = emberAfGetInt8u(message, msgIndex, msgLen);
    588                msgIndex++;
    589                printDiscoverCommandsResponse(TRUE,  // is ZCL command generated?
    590                                              clusterId,
    591                                              discoveryComplete,
    592                                              message + msgIndex,
    593                                              msgLen - msgIndex);
    594                if(!emberAfDiscoverCommandsGeneratedResponseCallback(clusterId,
    595                                                                     cmd->mfgCode,
    596                                                                     discoveryComplete,
    597                                                                     message+msgIndex,
    598                                                                     msgLen-msgIndex)) {
    599                  emberAfSendDefaultResponse(cmd, EMBER_ZCL_STATUS_SUCCESS);
    600                }
    601                return TRUE;
    602              }
    603              
    604          #endif
    605            }
    606          
    607          kickout:
    608            emberAfSendDefaultResponse(cmd,
    609                                       (cmd->mfgSpecific
    610                                        ? EMBER_ZCL_STATUS_UNSUP_MANUF_GENERAL_COMMAND
    611                                        : EMBER_ZCL_STATUS_UNSUP_GENERAL_COMMAND));
   \                     ??emAfProcessGlobalCommand_7:
   \   000002C4   0x7BE0             LDRB     R0,[R4, #+15]
   \   000002C6   0x2800             CMP      R0,#+0
   \   000002C8   0xF000 0x80B4      BEQ.W    ??emAfProcessGlobalCommand_28
   \                     ??emAfProcessGlobalCommand_4:
   \   000002CC   0x2184             MOVS     R1,#+132
   \   000002CE   0xE0AA             B.N      ??emAfProcessGlobalCommand_2
   \                     ??emAfProcessGlobalCommand_29:
   \   000002D0   0x4620             MOV      R0,R4
   \   000002D2   0x.... 0x....      BL       emberAfReadReportingConfigurationCommandCallback
   \   000002D6   0x2800             CMP      R0,#+0
   \   000002D8   0xD1EE             BNE.N    ??emAfProcessGlobalCommand_25
   \   000002DA   0xE7F3             B.N      ??emAfProcessGlobalCommand_7
   \                     ??emAfProcessGlobalCommand_30:
   \   000002DC   0xF1B8 0x0F0A      CMP      R8,#+10
   \   000002E0   0xD125             BNE.N    ??emAfProcessGlobalCommand_31
   \   000002E2   0x....             LDR.N    R5,??DataTable19_4
   \   000002E4   0x7828             LDRB     R0,[R5, #+0]
   \   000002E6   0xB310             CBZ.N    R0,??emAfProcessGlobalCommand_31
   \   000002E8   0x7BE0             LDRB     R0,[R4, #+15]
   \   000002EA   0x2800             CMP      R0,#+0
   \   000002EC   0xBF04             ITT      EQ 
   \   000002EE   0x1BB8             SUBEQ    R0,R7,R6
   \   000002F0   0x2808             CMPEQ    R0,#+8
   \   000002F2   0xD11C             BNE.N    ??emAfProcessGlobalCommand_31
   \   000002F4   0x.... 0x....      BL       ?Subroutine1
   \                     ??CrossCallReturnLabel_2:
   \   000002F8   0x2800             CMP      R0,#+0
   \   000002FA   0xBF01             ITTTT    EQ 
   \   000002FC   0xF89B 0x0002      LDRBEQ   R0,[R11, #+2]
   \   00000300   0x2800             CMPEQ    R0,#+0
   \   00000302   0xF89B 0x0003      LDRBEQ   R0,[R11, #+3]
   \   00000306   0x28E2             CMPEQ    R0,#+226
   \   00000308   0xD111             BNE.N    ??emAfProcessGlobalCommand_31
   \   0000030A   0x463A             MOV      R2,R7
   \   0000030C   0x1D31             ADDS     R1,R6,#+4
   \   0000030E   0xB289             UXTH     R1,R1
   \   00000310   0x4648             MOV      R0,R9
   \   00000312   0x.... 0x....      BL       emberAfGetInt32u
   \   00000316   0x.... 0x....      BL       emberAfSetTime
   \   0000031A   0x.... 0x....      BL       emberAfGetCurrentTime
   \   0000031E   0x4602             MOV      R2,R0
   \   00000320   0x.... 0x....      ADR.W    R1,`?<Constant "time sync ok, time: %4x">`
   \   00000324   0x2002             MOVS     R0,#+2
   \   00000326   0x.... 0x....      BL       emberAfPrintln
   \   0000032A   0x2000             MOVS     R0,#+0
   \   0000032C   0x7028             STRB     R0,[R5, #+0]
   \                     ??emAfProcessGlobalCommand_31:
   \   0000032E   0x.... 0x....      BL       ?Subroutine2
   \                     ??CrossCallReturnLabel_7:
   \   00000332   0x.... 0x....      BL       emberAfReadAttributesResponseCallback
   \   00000336   0xE074             B.N      ??emAfProcessGlobalCommand_32
   \                     ??emAfProcessGlobalCommand_33:
   \   00000338   0x.... 0x....      BL       ?Subroutine2
   \                     ??CrossCallReturnLabel_8:
   \   0000033C   0x.... 0x....      BL       emberAfWriteAttributesResponseCallback
   \   00000340   0xE06F             B.N      ??emAfProcessGlobalCommand_32
   \                     ??emAfProcessGlobalCommand_34:
   \   00000342   0x.... 0x....      BL       ?Subroutine2
   \                     ??CrossCallReturnLabel_9:
   \   00000346   0x.... 0x....      BL       emberAfConfigureReportingResponseCallback
   \   0000034A   0xE06A             B.N      ??emAfProcessGlobalCommand_32
   \                     ??emAfProcessGlobalCommand_35:
   \   0000034C   0x.... 0x....      BL       ?Subroutine2
   \                     ??CrossCallReturnLabel_10:
   \   00000350   0x.... 0x....      BL       emberAfReadReportingConfigurationResponseCallback
   \   00000354   0xE065             B.N      ??emAfProcessGlobalCommand_32
   \                     ??emAfProcessGlobalCommand_36:
   \   00000356   0x.... 0x....      BL       ?Subroutine2
   \                     ??CrossCallReturnLabel_11:
   \   0000035A   0x.... 0x....      BL       emberAfReportAttributesCallback
   \   0000035E   0xE060             B.N      ??emAfProcessGlobalCommand_32
   \                     ??emAfProcessGlobalCommand_37:
   \   00000360   0xF816 0x7009      LDRB     R7,[R6, R9]
   \   00000364   0xF810 0x5009      LDRB     R5,[R0, R9]
   \   00000368   0xF89D 0x000C      LDRB     R0,[SP, #+12]
   \   0000036C   0x9000             STR      R0,[SP, #+0]
   \   0000036E   0x462B             MOV      R3,R5
   \   00000370   0x463A             MOV      R2,R7
   \   00000372   0x4641             MOV      R1,R8
   \   00000374   0x6820             LDR      R0,[R4, #+0]
   \   00000376   0x7940             LDRB     R0,[R0, #+5]
   \   00000378   0x.... 0x....      BL       emberAfClusterDefaultResponseCallback
   \   0000037C   0x462A             MOV      R2,R5
   \   0000037E   0x4639             MOV      R1,R7
   \   00000380   0x4640             MOV      R0,R8
   \   00000382   0x.... 0x....      BL       emberAfDefaultResponseCallback
   \   00000386   0xE051             B.N      ??emAfProcessGlobalCommand_26
   \                     ??emAfProcessGlobalCommand_38:
   \   00000388   0xF816 0x1009      LDRB     R1,[R6, R9]
   \   0000038C   0x4606             MOV      R6,R0
   \   0000038E   0x2D16             CMP      R5,#+22
   \   00000390   0xBF0C             ITE      EQ 
   \   00000392   0x2001             MOVEQ    R0,#+1
   \   00000394   0x2000             MOVNE    R0,#+0
   \   00000396   0x9000             STR      R0,[SP, #+0]
   \   00000398   0x1BBB             SUBS     R3,R7,R6
   \   0000039A   0xB29B             UXTH     R3,R3
   \   0000039C   0xEB06 0x0209      ADD      R2,R6,R9
   \   000003A0   0x4640             MOV      R0,R8
   \   000003A2   0x.... 0x....      BL       emberAfDiscoverAttributesResponseCallback
   \   000003A6   0xE03C             B.N      ??emAfProcessGlobalCommand_32
   \                     ??emAfProcessGlobalCommand_39:
   \   000003A8   0xF816 0x9009      LDRB     R9,[R6, R9]
   \   000003AC   0xF89B 0x6001      LDRB     R6,[R11, #+1]
   \   000003B0   0x2D11             CMP      R5,#+17
   \   000003B2   0xD104             BNE.N    ??emAfProcessGlobalCommand_40
   \   000003B4   0x2012             MOVS     R0,#+18
   \   000003B6   0x.... 0x....      BL       emberAfPutInt8uInResp
   \   000003BA   0x2000             MOVS     R0,#+0
   \   000003BC   0xE003             B.N      ??emAfProcessGlobalCommand_41
   \                     ??emAfProcessGlobalCommand_40:
   \   000003BE   0x2014             MOVS     R0,#+20
   \   000003C0   0x.... 0x....      BL       emberAfPutInt8uInResp
   \   000003C4   0x2001             MOVS     R0,#+1
   \                     ??emAfProcessGlobalCommand_41:
   \   000003C6   0x....             LDR.N    R1,??DataTable19_2
   \   000003C8   0x880F             LDRH     R7,[R1, #+0]
   \   000003CA   0x9603             STR      R6,[SP, #+12]
   \   000003CC   0xF8CD 0x9008      STR      R9,[SP, #+8]
   \   000003D0   0x9101             STR      R1,[SP, #+4]
   \   000003D2   0xF1C7 0x0151      RSB      R1,R7,#+81
   \   000003D6   0xB289             UXTH     R1,R1
   \   000003D8   0x9100             STR      R1,[SP, #+0]
   \   000003DA   0x....             LDR.N    R1,??DataTable19_3
   \   000003DC   0x1879             ADDS     R1,R7,R1
   \   000003DE   0x1C4B             ADDS     R3,R1,#+1
   \   000003E0   0x4642             MOV      R2,R8
   \   000003E2   0x4621             MOV      R1,R4
   \   000003E4   0x.... 0x....      BL       emberAfExtractCommandIds
   \   000003E8   0xB100             CBZ.N    R0,??emAfProcessGlobalCommand_42
   \   000003EA   0x2001             MOVS     R0,#+1
   \                     ??emAfProcessGlobalCommand_42:
   \   000003EC   0x....             LDR.N    R1,??DataTable19_3
   \   000003EE   0x5478             STRB     R0,[R7, R1]
   \   000003F0   0x....             LDR.N    R0,??DataTable19_2
   \   000003F2   0x8800             LDRH     R0,[R0, #+0]
   \   000003F4   0x1C40             ADDS     R0,R0,#+1
   \   000003F6   0x....             LDR.N    R1,??DataTable19_2
   \   000003F8   0x8008             STRH     R0,[R1, #+0]
   \   000003FA   0xE75B             B.N      ??emAfProcessGlobalCommand_10
   \                     ??emAfProcessGlobalCommand_43:
   \   000003FC   0x.... 0x....      BL       ?Subroutine8
   \                     ??CrossCallReturnLabel_22:
   \   00000400   0x2000             MOVS     R0,#+0
   \   00000402   0x.... 0x....      BL       printDiscoverCommandsResponse
   \   00000406   0x.... 0x....      BL       ?Subroutine9
   \                     ??CrossCallReturnLabel_24:
   \   0000040A   0x.... 0x....      BL       emberAfDiscoverCommandsReceivedResponseCallback
   \   0000040E   0xE008             B.N      ??emAfProcessGlobalCommand_32
   \                     ??emAfProcessGlobalCommand_44:
   \   00000410   0x.... 0x....      BL       ?Subroutine8
   \                     ??CrossCallReturnLabel_23:
   \   00000414   0x2001             MOVS     R0,#+1
   \   00000416   0x.... 0x....      BL       printDiscoverCommandsResponse
   \   0000041A   0x.... 0x....      BL       ?Subroutine9
   \                     ??CrossCallReturnLabel_25:
   \   0000041E   0x.... 0x....      BL       emberAfDiscoverCommandsGeneratedResponseCallback
   \                     ??emAfProcessGlobalCommand_32:
   \   00000422   0xB918             CBNZ.N   R0,??emAfProcessGlobalCommand_26
   \                     ??emAfProcessGlobalCommand_23:
   \   00000424   0x2100             MOVS     R1,#+0
   \                     ??emAfProcessGlobalCommand_2:
   \   00000426   0x4620             MOV      R0,R4
   \   00000428   0x.... 0x....      BL       emberAfSendDefaultResponse
   \                     ??emAfProcessGlobalCommand_26:
   \   0000042C   0x2001             MOVS     R0,#+1
   \   0000042E   0xB005             ADD      SP,SP,#+20
   \   00000430   0xE8BD 0x8FF0      POP      {R4-R11,PC}      ;; return
   \                     ??emAfProcessGlobalCommand_28:
   \   00000434   0x2182             MOVS     R1,#+130
   \   00000436   0xE7F6             B.N      ??emAfProcessGlobalCommand_2
    612            return TRUE;
    613          }

   \                                 In section .text, align 2, keep-with-next
   \                     ?Subroutine9:
   \   00000000   0x9700             STR      R7,[SP, #+0]
   \   00000002   0x464B             MOV      R3,R9
   \   00000004   0x462A             MOV      R2,R5
   \   00000006   0x8A21             LDRH     R1,[R4, #+16]
   \   00000008   0x4640             MOV      R0,R8
   \   0000000A   0x4770             BX       LR

   \                                 In section .text, align 2, keep-with-next
   \                     ?Subroutine8:
   \   00000000   0xF816 0x5009      LDRB     R5,[R6, R9]
   \   00000004   0x4481             ADD      R9,R0,R9
   \   00000006   0x1A3F             SUBS     R7,R7,R0
   \   00000008   0xB2BF             UXTH     R7,R7
   \   0000000A   0x9700             STR      R7,[SP, #+0]
   \   0000000C   0x464B             MOV      R3,R9
   \   0000000E   0x462A             MOV      R2,R5
   \   00000010   0x4641             MOV      R1,R8
   \   00000012   0x4770             BX       LR

   \                                 In section .text, align 2, keep-with-next
   \                     ?Subroutine7:
   \   00000000   0xFA5F 0xF18B      UXTB     R1,R11
   \   00000004   0x1870             ADDS     R0,R6,R1
   \   00000006   0x1CC0             ADDS     R0,R0,#+3
   \   00000008   0xB286             UXTH     R6,R0
   \   0000000A   0x4770             BX       LR

   \                                 In section .text, align 2, keep-with-next
   \                     ?Subroutine6:
   \   00000000   0x4653             MOV      R3,R10
   \   00000002   0x4642             MOV      R2,R8
   \   00000004   0x.... 0x....      ADR.W    R1,`?<Constant "WRITE: clus %2x attr ...">`
   \   00000008   0x2010             MOVS     R0,#+16
   \   0000000A   0x4770             BX       LR

   \                                 In section .text, align 2, keep-with-next
   \                     ?Subroutine5:
   \   00000000   0xF89D 0x000E      LDRB     R0,[SP, #+14]
   \   00000004   0x1C40             ADDS     R0,R0,#+1
   \   00000006   0xF88D 0x000E      STRB     R0,[SP, #+14]
   \   0000000A   0x4770             BX       LR

   \                                 In section .text, align 2, keep-with-next
   \                     ?Subroutine4:
   \   00000000   0xF89D 0x2000      LDRB     R2,[SP, #+0]
   \   00000004   0x.... 0x....      ADR.W    R1,`?<Constant "FAIL %x">`
   \   00000008   0x2010             MOVS     R0,#+16
   \   0000000A   0x.... 0x....      B.W      emberAfPrintln

   \                                 In section .text, align 2, keep-with-next
   \                     ?Subroutine3:
   \   00000000   0x4682             MOV      R10,R0
   \   00000002   0xEB06 0x0009      ADD      R0,R6,R9
   \   00000006   0x9004             STR      R0,[SP, #+16]
   \   00000008   0x7880             LDRB     R0,[R0, #+2]
   \   0000000A   0xF88D 0x000D      STRB     R0,[SP, #+13]
   \   0000000E   0x.... 0x....      B.W      emberAfIsThisDataTypeAStringType

   \                                 In section .text, align 2, keep-with-next
   \                     ?Subroutine2:
   \   00000000   0xFA1F 0xF28A      UXTH     R2,R10
   \   00000004   0x4659             MOV      R1,R11
   \   00000006   0x4640             MOV      R0,R8
   \   00000008   0x4770             BX       LR

   \                                 In section .text, align 2, keep-with-next
   \                     ?Subroutine1:
   \   00000000   0x463A             MOV      R2,R7
   \   00000002   0x4631             MOV      R1,R6
   \   00000004   0x4648             MOV      R0,R9
   \   00000006   0x.... 0x....      B.W      emberAfGetInt16u

   \                                 In section .text, align 2, keep-with-next
   \                     ?Subroutine0:
   \   00000000   0xF89D 0x000D      LDRB     R0,[SP, #+13]
   \   00000004   0x9002             STR      R0,[SP, #+8]
   \   00000006   0x9804             LDR      R0,[SP, #+16]
   \   00000008   0x1CC0             ADDS     R0,R0,#+3
   \   0000000A   0x9001             STR      R0,[SP, #+4]
   \   0000000C   0x8A20             LDRH     R0,[R4, #+16]
   \   0000000E   0x9000             STR      R0,[SP, #+0]
   \   00000010   0xF89D 0x300C      LDRB     R3,[SP, #+12]
   \   00000014   0x4652             MOV      R2,R10
   \   00000016   0x4641             MOV      R1,R8
   \   00000018   0x6820             LDR      R0,[R4, #+0]
   \   0000001A   0x7940             LDRB     R0,[R0, #+5]
   \   0000001C   0x4770             BX       LR

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable18:
   \   00000000   0x00 0x00          DC8      "",0x0,0x0,0x0
   \              0x00 0x00    

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable19:
   \   00000000   0x4F 0x4B          DC8      0x4F, 0x4B, 0x00, 0x00
   \              0x00 0x00    

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable19_1:
   \   00000000   0x00 0x00          DC8      "",0x0,0x0,0x0
   \              0x00 0x00    

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable19_2:
   \   00000000   0x........         DC32     appResponseLength

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable19_3:
   \   00000000   0x........         DC32     appResponseData

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable19_4:
   \   00000000   0x........         DC32     emAfSyncingTime

   \                                 In section .rodata, align 1, keep-with-next
   \                     `?<Constant "">`:
   \   00000000   0x00               DC8 ""

   \                                 In section .text, align 4, keep-with-next
   \                     `?<Constant "Discover Commands res...">`:
   \   00000000   0x44 0x69          DC8 44H, 69H, 73H, 63H, 6FH, 76H, 65H, 72H
   \              0x73 0x63    
   \              0x6F 0x76    
   \              0x65 0x72    
   \   00000008   0x20 0x43          DC8 20H, 43H, 6FH, 6DH, 6DH, 61H, 6EH, 64H
   \              0x6F 0x6D    
   \              0x6D 0x61    
   \              0x6E 0x64    
   \   00000010   0x73 0x20          DC8 73H, 20H, 72H, 65H, 73H, 70H, 6FH, 6EH
   \              0x72 0x65    
   \              0x73 0x70    
   \              0x6F 0x6E    
   \   00000018   0x73 0x65          DC8 73H, 65H, 20H, 28H, 63H, 6FH, 6DH, 70H
   \              0x20 0x28    
   \              0x63 0x6F    
   \              0x6D 0x70    
   \   00000020   0x6C 0x65          DC8 6CH, 65H, 74H, 65H, 3AH, 20H, 25H, 63H
   \              0x74 0x65    
   \              0x3A 0x20    
   \              0x25 0x63    
   \   00000028   0x29 0x2C          DC8 29H, 2CH, 20H, 25H, 70H, 20H, 49H, 44H
   \              0x20 0x25    
   \              0x70 0x20    
   \              0x49 0x44    
   \   00000030   0x73 0x3A          DC8 73H, 3AH, 20H, 0
   \              0x20 0x00    

   \                                 In section .text, align 4, keep-with-next
   \                     `?<Constant "Generated">`:
   \   00000000   0x47 0x65          DC8 "Generated"
   \              0x6E 0x65    
   \              0x72 0x61    
   \              0x74 0x65    
   \              0x64 0x00    
   \   0000000A   0x00 0x00          DC8 0, 0

   \                                 In section .rodata, align 4, keep-with-next
   \                     `?<Constant "OK">`:
   \   00000000   0x4F 0x4B          DC8 "OK"
   \              0x00         
   \   00000003   0x00               DC8 0

   \                                 In section .text, align 4, keep-with-next
   \                     `?<Constant "Received">`:
   \   00000000   0x52 0x65          DC8 "Received"
   \              0x63 0x65    
   \              0x69 0x76    
   \              0x65 0x64    
   \              0x00         
   \   00000009   0x00 0x00          DC8 0, 0, 0
   \              0x00         

   \                                 In section .text, align 4, keep-with-next
   \                     `?<Constant "0x%X ">`:
   \   00000000   0x30 0x78          DC8 "0x%X "
   \              0x25 0x58    
   \              0x20 0x00    
   \   00000006   0x00 0x00          DC8 0, 0

   \                                 In section .text, align 4, keep-with-next
   \                     `?<Constant "disabled">`:
   \   00000000   0x64 0x69          DC8 "disabled"
   \              0x73 0x61    
   \              0x62 0x6C    
   \              0x65 0x64    
   \              0x00         
   \   00000009   0x00 0x00          DC8 0, 0, 0
   \              0x00         

   \                                 In section .text, align 4, keep-with-next
   \                     `?<Constant "%pd, dropping global ...">`:
   \   00000000   0x25 0x70          DC8 "%pd, dropping global cmd:%x"
   \              0x64 0x2C    
   \              0x20 0x64    
   \              0x72 0x6F    
   \              0x70 0x70    
   \              0x69 0x6E    
   \              0x67 0x20    
   \              0x67 0x6C    
   \              0x6F 0x62    
   \              0x61 0x6C    
   \              0x20 0x63    
   \              0x6D 0x64    
   \              0x3A 0x25    
   \              0x78 0x00    

   \                                 In section .text, align 4, keep-with-next
   \                     `?<Constant "disable">`:
   \   00000000   0x64 0x69          DC8 "disable"
   \              0x73 0x61    
   \              0x62 0x6C    
   \              0x65 0x00    

   \                                 In section .text, align 4, keep-with-next
   \                     `?<Constant "%p: clus %2x">`:
   \   00000000   0x25 0x70          DC8 "%p: clus %2x"
   \              0x3A 0x20    
   \              0x63 0x6C    
   \              0x75 0x73    
   \              0x20 0x25    
   \              0x32 0x78    
   \              0x00         
   \   0000000D   0x00 0x00          DC8 0, 0, 0
   \              0x00         

   \                                 In section .text, align 4, keep-with-next
   \                     `?<Constant "READ_ATTR">`:
   \   00000000   0x52 0x45          DC8 "READ_ATTR"
   \              0x41 0x44    
   \              0x5F 0x41    
   \              0x54 0x54    
   \              0x52 0x00    
   \   0000000A   0x00 0x00          DC8 0, 0

   \                                 In section .text, align 4, keep-with-next
   \                     `?<Constant "WRITE: clus %2x attr ...">`:
   \   00000000   0x57 0x52          DC8 "WRITE: clus %2x attr %2x "
   \              0x49 0x54    
   \              0x45 0x3A    
   \              0x20 0x63    
   \              0x6C 0x75    
   \              0x73 0x20    
   \              0x25 0x32    
   \              0x78 0x20    
   \              0x61 0x74    
   \              0x74 0x72    
   \              0x20 0x25    
   \              0x32 0x78    
   \              0x20 0x00    
   \   0000001A   0x00 0x00          DC8 0, 0

   \                                 In section .text, align 4, keep-with-next
   \                     `?<Constant "FAIL %x">`:
   \   00000000   0x46 0x41          DC8 "FAIL %x"
   \              0x49 0x4C    
   \              0x20 0x25    
   \              0x78 0x00    

   \                                 In section .text, align 4, keep-with-next
   \                     `?<Constant "WRITE: too short">`:
   \   00000000   0x57 0x52          DC8 "WRITE: too short"
   \              0x49 0x54    
   \              0x45 0x3A    
   \              0x20 0x74    
   \              0x6F 0x6F    
   \              0x20 0x73    
   \              0x68 0x6F    
   \              0x72 0x74    
   \              0x00         
   \   00000011   0x00 0x00          DC8 0, 0, 0
   \              0x00         

   \                                 In section .text, align 4, keep-with-next
   \                     `?<Constant "%p%p: clus %2x">`:
   \   00000000   0x25 0x70          DC8 "%p%p: clus %2x"
   \              0x25 0x70    
   \              0x3A 0x20    
   \              0x63 0x6C    
   \              0x75 0x73    
   \              0x20 0x25    
   \              0x32 0x78    
   \              0x00         
   \   0000000F   0x00               DC8 0

   \                                 In section .text, align 4, keep-with-next
   \                     `?<Constant "DISC_ATTR">`:
   \   00000000   0x44 0x49          DC8 "DISC_ATTR"
   \              0x53 0x43    
   \              0x5F 0x41    
   \              0x54 0x54    
   \              0x52 0x00    
   \   0000000A   0x00 0x00          DC8 0, 0

   \                                 In section .text, align 4, keep-with-next
   \                     `?<Constant "_EXT">`:
   \   00000000   0x5F 0x45          DC8 "_EXT"
   \              0x58 0x54    
   \              0x00         
   \   00000005   0x00 0x00          DC8 0, 0, 0
   \              0x00         

   \                                 In section .text, align 4, keep-with-next
   \                     `?<Constant "time sync ok, time: %4x">`:
   \   00000000   0x74 0x69          DC8 "time sync ok, time: %4x"
   \              0x6D 0x65    
   \              0x20 0x73    
   \              0x79 0x6E    
   \              0x63 0x20    
   \              0x6F 0x6B    
   \              0x2C 0x20    
   \              0x74 0x69    
   \              0x6D 0x65    
   \              0x3A 0x20    
   \              0x25 0x34    
   \              0x78 0x00    
    614          
    615          

   Maximum stack usage in bytes:

   .cstack Function
   ------- --------
       56  emAfProcessGlobalCommand
             56 -> emberAfClusterDefaultResponseCallback
             56 -> emberAfConfigureReportingCommandCallback
             56 -> emberAfConfigureReportingResponseCallback
             56 -> emberAfDefaultResponseCallback
             56 -> emberAfDiscoverAttributesResponseCallback
             56 -> emberAfDiscoverCommandsGeneratedResponseCallback
             56 -> emberAfDiscoverCommandsReceivedResponseCallback
             56 -> emberAfExtractCommandIds
             56 -> emberAfGetCurrentTime
             56 -> emberAfGetDataSize
             56 -> emberAfGetInt16u
             56 -> emberAfGetInt32u
             56 -> emberAfIsDeviceEnabled
             56 -> emberAfIsThisDataTypeAStringType
             56 -> emberAfPrint
             56 -> emberAfPrintln
             56 -> emberAfPutInt16uInResp
             56 -> emberAfPutInt8uInResp
             56 -> emberAfReadAttributesResponseCallback
             56 -> emberAfReadReportingConfigurationCommandCallback
             56 -> emberAfReadReportingConfigurationResponseCallback
             56 -> emberAfReadSequentialAttributesAddToResponse
             56 -> emberAfReportAttributesCallback
             56 -> emberAfRetrieveAttributeAndCraftResponse
             56 -> emberAfSendDefaultResponse
             56 -> emberAfSendResponse
             56 -> emberAfSetTime
             56 -> emberAfStringLength
             56 -> emberAfVerifyAttributeWrite
             56 -> emberAfWriteAttributeExternal
             56 -> emberAfWriteAttributesResponseCallback
             56 -> printDiscoverCommandsResponse
       24  printDiscoverCommandsResponse
             24 -> emberAfPrint
              0 -> emberAfPrintln


   Section sizes:

   Bytes  Function/Label
   -----  --------------
       1  ?<Constant "">
      16  ?<Constant "%p%p: clus %2x">
      16  ?<Constant "%p: clus %2x">
      28  ?<Constant "%pd, dropping global ...">
       8  ?<Constant "0x%X ">
      12  ?<Constant "DISC_ATTR">
      52  ?<Constant "Discover Commands res...">
       8  ?<Constant "FAIL %x">
      12  ?<Constant "Generated">
       4  ?<Constant "OK">
      12  ?<Constant "READ_ATTR">
      12  ?<Constant "Received">
      28  ?<Constant "WRITE: clus %2x attr ...">
      20  ?<Constant "WRITE: too short">
       8  ?<Constant "_EXT">
       8  ?<Constant "disable">
      12  ?<Constant "disabled">
      24  ?<Constant "time sync ok, time: %4x">
       4  ??DataTable18
       4  ??DataTable19
       4  ??DataTable19_1
       4  ??DataTable19_2
       4  ??DataTable19_3
       4  ??DataTable19_4
      30  ?Subroutine0
      10  ?Subroutine1
      10  ?Subroutine2
      18  ?Subroutine3
      14  ?Subroutine4
      12  ?Subroutine5
      12  ?Subroutine6
      12  ?Subroutine7
      20  ?Subroutine8
      12  ?Subroutine9
    1080  emAfProcessGlobalCommand
       1  emAfSyncingTime
      78  printDiscoverCommandsResponse

 
     1 byte  in section .bss
     5 bytes in section .rodata
 1 608 bytes in section .text
 
 1 608 bytes of CODE  memory
     5 bytes of CONST memory
     1 byte  of DATA  memory

Errors: none
Warnings: none
